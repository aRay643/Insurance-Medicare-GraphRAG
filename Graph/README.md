# ä¿é™©-è¯å“-å…»è€ çŸ¥è¯†å›¾è°± (Insurance-Medicine-NursingHome Knowledge Graph)

åŸºäºŽ Neo4j å›¾æ•°æ®åº“æž„å»ºçš„è·¨åŸŸçŸ¥è¯†å›¾è°±ï¼Œè¦†ç›– **ä¿é™©äº§å“**ã€**åˆ›æ–°è¯å“** å’Œ **å…»è€æœºæž„** ä¸‰å¤§é¢†åŸŸï¼Œé€šè¿‡è‡ªç„¶å®žä½“å…³è”å’Œæ¡¥æŽ¥å…³ç³»å®žçŽ°è·¨åŸŸæŸ¥è¯¢ã€‚

## ðŸ“Š æ•°æ®è§„æ¨¡

| æŒ‡æ ‡ | æ•°é‡ |
|------|------|
| èŠ‚ç‚¹æ€»æ•° | 60,515 |
| å…³ç³»æ€»æ•° | 118,896 |
| ä¿é™©äº§å“ | 128 |
| å…»è€æœºæž„ | 56,368 |
| è¯å“å®žä½“ | 128 (å«å“ç‰Œ/å…¬å¸) |
| ç–¾ç—…å®žä½“ | 136 |
| è·¨åŸŸè·¯å¾„ | 15,899 |

## ðŸ—ï¸ é¡¹ç›®ç»“æž„

```
â”œâ”€â”€ prompts/                         # LLM æå– Prompt (V6 æœ€ç»ˆç‰ˆ)
â”‚   â”œâ”€â”€ insurance_prompt_v6.md       # ä¿é™©æ•°æ®æå– Prompt
â”‚   â”œâ”€â”€ nursing_home_prompt_v6.md    # å…»è€æœºæž„æ•°æ®æå– Prompt
â”‚   â””â”€â”€ medicine_prompt_v6.md        # å•†ä¸šåˆ›æ–°è¯å“ Prompt
â”‚
â”œâ”€â”€ Seeds/                           # é€šç”¨æœ¯è¯­ç§å­æ•°æ®
â”‚   â””â”€â”€ common_terms.json            # çŠ¹è±«æœŸã€ç­‰å¾…æœŸç­‰æ ‡å‡†å®šä¹‰
â”‚
â”œâ”€â”€ db_data/                         # å›¾è°±æ•°æ® (JSON ä¸‰å…ƒç»„)
â”‚   â”œâ”€â”€ Insurance_v2/                # ä¿é™©ä¸‰å…ƒç»„æ•°æ® (105 æ–‡ä»¶)
â”‚   â”œâ”€â”€ Medicine_v2/                 # è¯å“ä¸‰å…ƒç»„æ•°æ® (1 æ–‡ä»¶)
â”‚   â””â”€â”€ NursingHome_v2/              # å…»è€æœºæž„ä¸‰å…ƒç»„æ•°æ® (1168 æ–‡ä»¶)
â”‚
â”œâ”€â”€ source/                          # åŽŸå§‹æ•°æ®æº
â”‚   â”œâ”€â”€ insurance/                   # ä¿é™©æ¡æ¬¾æ–‡æœ¬
â”‚   â””â”€â”€ medicine_pdf/                # è¯å“ç›®å½• PDF
â”‚
â”œâ”€â”€ scripts/                         # Python å·¥å…·è„šæœ¬
â”‚   â”œâ”€â”€ import_to_neo4j.py           # Neo4j å¯¼å…¥è„šæœ¬
â”‚   â”œâ”€â”€ test_neo4j.py                # æ•°æ®åº“åŠŸèƒ½æµ‹è¯•
â”‚   â””â”€â”€ extract_pdf_text_00_105.py   # PDF æ–‡æœ¬æå–å·¥å…·
â”‚
â”œâ”€â”€ requirements.txt                 # Python ä¾èµ–
â””â”€â”€ README.md
```

## ðŸš€ å¿«é€Ÿå¼€å§‹

### 1. çŽ¯å¢ƒå‡†å¤‡

#### Python çŽ¯å¢ƒ

```bash
# å®‰è£… Python ä¾èµ–
pip install -r requirements.txt
```

#### Neo4j æ•°æ®åº“é…ç½®

æœ¬è„šæœ¬é»˜è®¤è¿žæŽ¥æœ¬åœ°æ•°æ®åº“ `bolt://127.0.0.1:7687`ã€‚

**0. æ–‡ä»¶é…ç½®**
1. **ä¸‰å…ƒç»„é…ç½®**ï¼šå°†ä¸‹è½½çš„db_dataåŽ‹ç¼©åŒ…è§£åŽ‹ç¼©å¹¶æ”¾åˆ°æ ¹ç›®å½•ä¸‹ã€‚
2. **åŽŸå§‹æ•°æ®é…ç½®**ï¼šå°†ä¸‹è½½çš„sourceåŽ‹ç¼©åŒ…è§£åŽ‹ç¼©ï¼Œæ”¾åˆ°æ ¹ç›®å½•ä¸‹ã€‚ï¼ˆå¯é€‰ï¼‰

**1. ä¸‹è½½ä¸Žå®‰è£…**
- è®¿é—® [Neo4j Download Center](https://neo4j.com/download/) ä¸‹è½½å¹¶å®‰è£… **Neo4j Desktop**ã€‚
- å¯åŠ¨ Neo4j Desktop å¹¶ç¡®ä¿å®‰è£…äº† Databaseã€‚

**2. åˆ›å»ºæ•°æ®åº“ï¼ˆä½¿ç”¨ Neo4j Desktopï¼‰**
1. **æ–°å»ºé¡¹ç›®**: åœ¨ Neo4j Desktop ä¸­åˆ›å»ºä¸€ä¸ªæ–° Projectã€‚
2. **æ·»åŠ æ•°æ®åº“**: ç‚¹å‡» `Add` -> `Local DBMS` åˆ›å»ºå›¾æ•°æ®åº“ã€‚
3. **è®¾ç½®å¯†ç **: å»ºè®®è®¾ç½®å¯†ç ä¸º **`88888888`**ã€‚
   - *å¦‚æžœä½¿ç”¨å…¶ä»–å¯†ç ï¼Œè¯·ä¿®æ”¹ `scripts/import_to_neo4j.py` å’Œ `scripts/test_neo4j.py` ä¸­çš„ `NEO4J_PASSWORD` å˜é‡ã€‚*
4. **å®‰è£…æ’ä»¶**: (å¯é€‰) æŽ¨èå®‰è£… **APOC** æ’ä»¶ä»¥æ”¯æŒæ›´é«˜çº§çš„å›¾ç®—æ³•ã€‚
5. **å¯åŠ¨æœåŠ¡**: ç‚¹å‡» `Start`ï¼Œç­‰å¾…æ•°æ®åº“çŠ¶æ€å˜ä¸º `Active`ã€‚
6. **ç¡®è®¤ç«¯å£**: ç¡®ä¿ Bolt ç«¯å£ä¸ºé»˜è®¤çš„ `7687`ï¼ˆå¯åœ¨ DBMS çš„ Settings ä¸­æŸ¥çœ‹ `dbms.connector.bolt.listen_address`ï¼‰ã€‚

### 2. å¯¼å…¥æ•°æ®

```bash
# å…¨é‡å¯¼å…¥ï¼ˆæ¸…ç©ºåŽé‡å¯¼ï¼‰
python scripts/import_to_neo4j.py --clear

# å¢žé‡å¯¼å…¥ï¼ˆä¿ç•™å·²æœ‰æ•°æ®ï¼‰
python scripts/import_to_neo4j.py
```

### 3. éªŒè¯å¯¼å…¥

```bash
python scripts/test_neo4j.py
```

## ðŸ”— çŸ¥è¯†å›¾è°± Schema

### èŠ‚ç‚¹ç±»åž‹

| æ ‡ç­¾ | è¯´æ˜Ž | æ¥æº |
|------|------|------|
| `Product` | ä¿é™©äº§å“ / è¯å“ | ä¿é™© + è¯å“ |
| `ProductCategory` | ä¿é™©ç±»åˆ«ï¼ˆåŒ»ç–—/å…»è€/æŠ¤ç†ç­‰ï¼‰ | ä¿é™© |
| `Benefit` | ä¿éšœé¡¹ç›® | ä¿é™© |
| `Exclusion` | å…è´£æ¡æ¬¾ | ä¿é™© |
| `Condition` | åˆåŒæ¡ä»¶ï¼ˆçŠ¹è±«æœŸç­‰ï¼‰ | ä¿é™© + ç§å­ |
| `Eligibility` | æŠ•ä¿èµ„æ ¼ | ä¿é™© |
| `Medical` | ç–¾ç—…/é€‚åº”ç—‡ | ä¿é™© + è¯å“ |
| `Brand` | è¯å“å•†å“å | è¯å“ |
| `Company` | åˆ¶è¯å…¬å¸ | è¯å“ |
| `Insurance` | è¯å“ç›®å½• | è¯å“ |
| `Org` | å…»è€æœºæž„ | å…»è€ |
| `District` | åŒº/åŽ¿ | å…»è€ |
| `Province` | çœ/ç›´è¾–å¸‚ | å…»è€ |
| `Service` | æœåŠ¡ç±»åž‹ | å…»è€ + ä¿é™© |

### å…³ç³»ç±»åž‹

| å…³ç³» | è¯´æ˜Ž |
|------|------|
| `COVERS` | ä¿é™©äº§å“ â†’ ä¿éšœé¡¹ç›® |
| `HAS_EXCLUSION` | ä¿é™©äº§å“ â†’ å…è´£æ¡æ¬¾ |
| `BELONGS_TO_CATEGORY` | ä¿é™©äº§å“ â†’ äº§å“ç±»åˆ« |
| `ELIGIBILITY` | ä¿é™©äº§å“ â†’ æŠ•ä¿èµ„æ ¼ |
| `TREATS` | è¯å“ â†’ ç–¾ç—… |
| `HAS_TRADE_NAME` | è¯å“ â†’ å•†å“å |
| `PRODUCED_BY` | è¯å“ â†’ åˆ¶è¯å…¬å¸ |
| `LOCATED_IN` | å…»è€æœºæž„ â†’ åŒºåŸŸ |
| `PROVIDES_SERVICE` | å…»è€æœºæž„ â†’ æœåŠ¡ç±»åž‹ |
| `SUITABLE_FOR` | æœåŠ¡ç±»åž‹ â†’ ä¿é™©ç±»åˆ«ï¼ˆè·¨åŸŸæ¡¥æŽ¥ï¼‰ |

### è·¨åŸŸæŸ¥è¯¢è·¯å¾„

```
å…»è€æœºæž„(Org) â†’[PROVIDES_SERVICE]â†’ æœåŠ¡(Service)
    â†’[SUITABLE_FOR]â†’ ä¿é™©ç±»åˆ«(ProductCategory)
        â†[BELONGS_TO_CATEGORY]â† ä¿é™©äº§å“(Product)
```

## ðŸ“– ä¸šåŠ¡åœºæ™¯ç¤ºä¾‹

```cypher
-- åœºæ™¯1: æŸ¥æ‰¾åŒ—äº¬æœ‰åŒ»ç–—è®¾æ–½çš„å…»è€æœºæž„
MATCH (o:Org)-[r:LOCATED_IN]->(d:District)-[:BELONGS_TO]->(p:Province {name: 'åŒ—äº¬å¸‚'})
WHERE r.has_medical_facility = true
RETURN o.name, d.name, r.bed_count
ORDER BY r.bed_count DESC LIMIT 10

-- åœºæ™¯2: æŸ¥æ‰¾æ²»ç–—è‚ºç™Œçš„è¯å“åŠå“ç‰Œ
MATCH (p:Product)-[r:TREATS]->(m:Medical)
WHERE m.name CONTAINS 'è‚ºç™Œ'
OPTIONAL MATCH (p)-[:HAS_TRADE_NAME]->(b:Brand)
RETURN p.name, b.name, r.indication_limit

-- åœºæ™¯3: è·¨åŸŸ - ä¸ºå…»è€æœºæž„æŽ¨èä¿é™©äº§å“
MATCH (o:Org)-[:PROVIDES_SERVICE]->(s:Service)
      -[:SUITABLE_FOR]->(pc:ProductCategory)
      <-[:BELONGS_TO_CATEGORY]-(p:Product)
WHERE o.name CONTAINS 'æŠ¤ç†'
RETURN DISTINCT o.name, s.name, pc.name, p.name
```

## âš™ï¸ é…ç½®

Neo4j è¿žæŽ¥å‚æ•°åœ¨ `scripts/import_to_neo4j.py` å¤´éƒ¨é…ç½®ï¼š

```python
NEO4J_URI = "bolt://127.0.0.1:7687"
NEO4J_USER = "neo4j"
NEO4J_PASSWORD = "88888888"
NEO4J_DATABASE = "neo4j"
```

## ðŸ”§ æ•°æ®æå–æµç¨‹ï¼ˆæ•°æ®åº“å»ºç«‹è¿‡ç¨‹å¤çŽ°ï¼Œå¯¼å…¥æ•°æ®åº“æ— éœ€è¿›è¡Œï¼‰

1. **åŽŸå§‹æ•°æ®** â†’ æ”¾å…¥ `source/` ç›®å½•
2. **æ–‡æœ¬æå–** â†’ è¿è¡Œ `scripts/extract_pdf_text_00_105.py`ï¼ˆä»…é™ä¿é™©æ¡æ¬¾ï¼‰
3. **LLM æå–** â†’ ä½¿ç”¨ `prompts/` ä¸­çš„ V6 Prompt æŒ‡å¯¼ LLM ä»Žæ–‡æœ¬ä¸­æŠ½å–ä¸‰å…ƒç»„
4. **JSON è¾“å‡º** â†’ æå–ç»“æžœä¿å­˜ä¸º JSON ä¸‰å…ƒç»„æ ¼å¼è‡³ `db_data/*_v2/` ç›®å½•
5. **Neo4j å¯¼å…¥** â†’ è¿è¡Œ `scripts/import_to_neo4j.py`
6. **éªŒè¯æµ‹è¯•** â†’ è¿è¡Œ `scripts/test_neo4j.py`
